<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Home</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Home</h1>

    



    


    <h3>snyk-take-home 1.0.0</h3>










    




    <section>
        <article><h2>Computing the Dependency Tree for an NPM Package</h2>
<p>This project exposes an API for computing a given NPM package's dependency tree. It was built using <a href="https://nodejs.org/en/">Node.js</a> and <a href="https://expressjs.com/">Express</a> and tested using <a href="https://mochajs.org/">Mocha</a>.</p>
<p>The API was implemented with Node.js v12.</p>
<p><strong>Note 1</strong> The API only retrieves dependencies, so no <code>devDependencies</code>, <code>peerDependencies</code>, or <code>optionalDepdendencies</code> for now. Although it could be extended to include those very easily.
<strong>Note 2</strong> If provided with a version of <code>latest</code>, it never gets cached.</p>
<h3>Project structure</h3>
<pre class="prettyprint source"><code>.
+-- docs - documentation
+-- lib - business logic
+-- persistence - for now just the cache management logic
+-- routes - Express router and middleware
+-- test - unit tests
+-- utils - utility functions (error handling, logging, validation, and NPM registry management logic)
+-- app.js - Express app
+-- server.js
</code></pre>
<h3>How to run</h3>
<p>Run <code>npm start</code> and this will start up a server on port <code>3000</code> of <code>localhost</code></p>
<h3>API</h3>
<p>Call the following APIs at <code>http://localhost:3000</code>:</p>
<ul>
<li>GET <code>/package/&lt;package&gt;</code>, where <code>&lt;package&gt;</code> is the name of a package published to NPM
e.g.</li>
</ul>
<pre class="prettyprint source lang-sh"><code>curl -X GET http://localhost:3000/package/express
</code></pre>
<ul>
<li>POST <code>/package/&lt;package&gt;</code> with JSON body and a provided <code>version</code> field</li>
</ul>
<pre class="prettyprint source lang-sh"><code>curl -X POST http://localhost:3000/package/express -d '{ &quot;version&quot;: &quot;latest&quot; }'
</code></pre>
<p>The response format is:</p>
<pre class="prettyprint source"><code>{
  &quot;name&quot;: &quot;&lt;package name>&quot;,
  &quot;version&quot;: &quot;&lt;package version>&quot;,
  &quot;dependencies&quot;: [
    {
      &quot;name&quot;: &quot;&lt;dependency name>&quot;,
      &quot;version&quot;: &quot;&lt;dependency version>&quot;,
      &quot;dependencies&quot;: [
          ...
      ]
    }
  ]
}
</code></pre>
<h3>How to test</h3>
<p>Run <code>npm t</code> and this will lint the code, run Mocha tests and gather coverage statistics under <code>/reports</code>, and finally generate documentation under <code>/docs</code>.</p>
<h3>Performance statistics</h3>
<p>Using <a href="https://artillery.io/">Artillery</a>, I have gathered some statistics. These depend on external factors but show the benefits of caching.</p>
<p>To install Artillery, run:</p>
<pre class="prettyprint source lang-sh"><code>npm i -g artillery
</code></pre>
<p>Without caching, we see that without caching 95% and 99% of the requests take 12s, whereas the minimum one can take is 4s.</p>
<pre class="prettyprint source lang-sh"><code>artillery quick -c 10 -n 20 http://localhost:3000/package/express

Summary report @ 15:07:02(+0000) 2021-02-13
  Scenarios launched:  10
  Scenarios completed: 10
  Requests completed:  200
  Mean response/sec: 1.07
  Response time (msec):
    min: 4836
    max: 13096.9
    median: 9047.1
    p95: 11433.9
    p99: 12509.3
  Scenario counts:
    0: 10 (100%)
  Codes:
    200: 200
</code></pre>
<p>With caching, we see that 95% and 99% percent of the requests take 2s - 3s, whereas the minimum one can take is 0.6s:</p>
<pre class="prettyprint source lang-sh"><code>artillery quick -c 10 -n 20 http://localhost:3000/package/express

Summary report @ 15:20:14(+0000) 2021-02-13
  Scenarios launched:  10
  Scenarios completed: 10
  Requests completed:  200
  Mean response/sec: 5.25
  Response time (msec):
    min: 693.3
    max: 3015.6
    median: 1811.6
    p95: 2525.9
    p99: 2911.3
  Scenario counts:
    0: 10 (100%)
  Codes:
    200: 200
</code></pre></article>
    </section>






</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#_formatDependencies">_formatDependencies</a></li><li><a href="global.html#_getMatchingVersion">_getMatchingVersion</a></li><li><a href="global.html#_getPackageDependencies">_getPackageDependencies</a></li><li><a href="global.html#_hasCyclicDependency">_hasCyclicDependency</a></li><li><a href="global.html#_makeRegistryCall">_makeRegistryCall</a></li><li><a href="global.html#computeDependencyTreeForPackage">computeDependencyTreeForPackage</a></li><li><a href="global.html#downloadPackage">downloadPackage</a></li><li><a href="global.html#downloadPackageWithVersion">downloadPackageWithVersion</a></li><li><a href="global.html#formatError">formatError</a></li><li><a href="global.html#validateName">validateName</a></li><li><a href="global.html#validateVersion">validateVersion</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Sat Feb 13 2021 17:11:39 GMT+0000 (Greenwich Mean Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>