<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>snyk-take-home</title>
	<meta name="description" content="Documentation for snyk-take-home">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
	<script async src="assets/js/search.js" id="search-script"></script>
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">snyk-take-home</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<h1>snyk-take-home</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#computing-the-dependency-tree-for-an-npm-package" id="computing-the-dependency-tree-for-an-npm-package" style="color: inherit; text-decoration: none;">
					<h2>Computing the Dependency Tree for an NPM Package</h2>
				</a>
				<p>This project exposes an API for computing a given NPM package&#39;s dependency tree. It was built using <a href="https://nodejs.org/en/">Node.js</a> and <a href="https://expressjs.com/">Express</a> and tested using <a href="https://mochajs.org/">Mocha</a>.</p>
				<p>The API was implemented with Node.js v12.</p>
				<p><strong>Note 1</strong> The API only retrieves dependencies, so no <code>devDependencies</code>, <code>peerDependencies</code>, or <code>optionalDepdendencies</code> for now. Although it could be extended to include those very easily.
				<strong>Note 2</strong> If provided with a version of <code>latest</code>, it never gets cached.</p>
				<a href="#project-structure" id="project-structure" style="color: inherit; text-decoration: none;">
					<h3>Project structure</h3>
				</a>
				<pre><code><span style="color: #000000">.</span>
<span style="color: #000000">+-- </span><span style="color: #001080">docs</span><span style="color: #000000"> - </span><span style="color: #001080">documentation</span>
<span style="color: #000000">+-- </span><span style="color: #001080">lib</span><span style="color: #000000"> - </span><span style="color: #001080">business</span><span style="color: #000000"> </span><span style="color: #001080">logic</span>
<span style="color: #000000">+-- </span><span style="color: #001080">persistence</span><span style="color: #000000"> - </span><span style="color: #001080">for</span><span style="color: #000000"> </span><span style="color: #001080">now</span><span style="color: #000000"> </span><span style="color: #001080">just</span><span style="color: #000000"> </span><span style="color: #001080">the</span><span style="color: #000000"> </span><span style="color: #001080">cache</span><span style="color: #000000"> </span><span style="color: #001080">management</span><span style="color: #000000"> </span><span style="color: #001080">logic</span>
<span style="color: #000000">+-- </span><span style="color: #001080">routes</span><span style="color: #000000"> - </span><span style="color: #001080">Express</span><span style="color: #000000"> </span><span style="color: #001080">router</span><span style="color: #000000"> </span><span style="color: #001080">and</span><span style="color: #000000"> </span><span style="color: #001080">middleware</span>
<span style="color: #000000">+-- </span><span style="color: #001080">test</span><span style="color: #000000"> - </span><span style="color: #001080">unit</span><span style="color: #000000"> </span><span style="color: #001080">tests</span>
<span style="color: #000000">+-- </span><span style="color: #001080">utils</span><span style="color: #000000"> - </span><span style="color: #001080">utility</span><span style="color: #000000"> </span><span style="color: #795E26">functions</span><span style="color: #000000"> (</span><span style="color: #001080">error</span><span style="color: #000000"> </span><span style="color: #001080">handling</span><span style="color: #000000">, </span><span style="color: #001080">logging</span><span style="color: #000000">, </span><span style="color: #001080">validation</span><span style="color: #000000">, </span><span style="color: #001080">and</span><span style="color: #000000"> </span><span style="color: #0070C1">NPM</span><span style="color: #000000"> </span><span style="color: #001080">registry</span><span style="color: #000000"> </span><span style="color: #001080">management</span><span style="color: #000000"> </span><span style="color: #001080">logic</span><span style="color: #000000">)</span>
<span style="color: #000000">+-- </span><span style="color: #001080">app</span><span style="color: #000000">.</span><span style="color: #001080">js</span><span style="color: #000000"> - </span><span style="color: #001080">Express</span><span style="color: #000000"> </span><span style="color: #001080">app</span>
<span style="color: #000000">+-- </span><span style="color: #001080">server</span><span style="color: #000000">.</span><span style="color: #001080">js</span>
</code></pre>
				<a href="#how-to-run" id="how-to-run" style="color: inherit; text-decoration: none;">
					<h3>How to run</h3>
				</a>
				<p>Run <code>npm start</code> and this will start up a server on port <code>3000</code> of <code>localhost</code></p>
				<a href="#api" id="api" style="color: inherit; text-decoration: none;">
					<h3>API</h3>
				</a>
				<p>Call the following APIs at <code>http://localhost:3000</code>:</p>
				<ul>
					<li>GET <code>/package/&lt;package&gt;</code>, where <code>&lt;package&gt;</code> is the name of a package published to NPM
						e.g.<pre><code class="language-sh"><span style="color: #000000">curl -X GET http://localhost:3000/package/express</span>
</code></pre>
					</li>
					<li>POST <code>/package/&lt;package&gt;</code> with JSON body and a provided <code>version</code> field<pre><code class="language-sh"><span style="color: #000000">curl -X POST http://localhost:3000/package/express -d </span><span style="color: #A31515">&#039;{ &quot;version&quot;: &quot;latest&quot; }&#039;</span>
</code></pre>
					</li>
				</ul>
				<p>The response format is:</p>
				<pre><code><span style="color: #000000">{</span>
<span style="color: #000000">  </span><span style="color: #A31515">&quot;&lt;package name&gt;&quot;</span><span style="color: #000000">: {</span>
<span style="color: #000000">    </span><span style="color: #A31515">&quot;version&quot;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;&lt;package version&gt;&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #A31515">&quot;dependencies&quot;</span><span style="color: #001080">:</span><span style="color: #000000"> [</span>
<span style="color: #000000">      {</span>
<span style="color: #000000">        </span><span style="color: #A31515">&quot;&lt;dependency name&gt;&quot;</span><span style="color: #001080">:</span><span style="color: #000000"> {</span>
<span style="color: #000000">          </span><span style="color: #A31515">&quot;version&quot;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;&lt;dependency version&gt;&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">          </span><span style="color: #A31515">&quot;dependencies&quot;</span><span style="color: #001080">:</span><span style="color: #000000"> {</span>
<span style="color: #000000">              ...</span>
<span style="color: #000000">          }</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">      }</span>
<span style="color: #000000">    ]</span>
<span style="color: #000000">  }</span>
<span style="color: #000000">}</span>
</code></pre>
				<a href="#how-to-test" id="how-to-test" style="color: inherit; text-decoration: none;">
					<h3>How to test</h3>
				</a>
				<p>Run <code>npm t</code> and this will lint the code, run Mocha tests and gather coverage statistics under <code>/reports</code>, and finally generate documentation under <code>/docs</code>.</p>
				<a href="#performance-statistics" id="performance-statistics" style="color: inherit; text-decoration: none;">
					<h3>Performance statistics</h3>
				</a>
				<p>Using <a href="https://artillery.io/">Artillery</a>, I have gathered some statistics. These depend on external factors but show the benefits of caching.</p>
				<p>To install Artillery, run:</p>
				<pre><code class="language-sh"><span style="color: #000000">npm i -g artillery</span>
</code></pre>
				<p>Without caching, we see that without caching 95% and 99% of the requests take 12s, whereas the minimum one can take is 4s.</p>
				<pre><code class="language-sh"><span style="color: #000000">artillery quick -c 10 -n 20 http://localhost:3000/package/express</span>

<span style="color: #000000">Summary report @ 18:47:57(+0000) 2021-02-20</span>
<span style="color: #000000">  Scenarios launched:  10</span>
<span style="color: #000000">  Scenarios completed: 10</span>
<span style="color: #000000">  Requests completed:  200</span>
<span style="color: #000000">  Mean response/sec: 1.62</span>
<span style="color: #000000">  Response </span><span style="color: #0000FF">time</span><span style="color: #000000"> (msec):</span>
<span style="color: #000000">    min: 1552.8</span>
<span style="color: #000000">    max: 10919.2</span>
<span style="color: #000000">    median: 5934.6</span>
<span style="color: #000000">    p95: 8162.1</span>
<span style="color: #000000">    p99: 9758.3</span>
<span style="color: #000000">  Scenario counts:</span>
<span style="color: #000000">    0: 10 (100%)</span>
<span style="color: #000000">  Codes:</span>
<span style="color: #000000">    200: 200</span>
</code></pre>
				<p>With caching, we see that 95% and 99% percent of the requests take 2s - 3s, whereas the minimum one can take is 0.6s:</p>
				<pre><code class="language-sh"><span style="color: #000000">artillery quick -c 10 -n 20 http://localhost:3000/package/express</span>

<span style="color: #000000">Summary report @ 18:49:23(+0000) 2021-02-20</span>
<span style="color: #000000">  Scenarios launched:  10</span>
<span style="color: #000000">  Scenarios completed: 10</span>
<span style="color: #000000">  Requests completed:  200</span>
<span style="color: #000000">  Mean response/sec: 5.97</span>
<span style="color: #000000">  Response </span><span style="color: #0000FF">time</span><span style="color: #000000"> (msec):</span>
<span style="color: #000000">    min: 343</span>
<span style="color: #000000">    max: 4577.2</span>
<span style="color: #000000">    median: 1385.3</span>
<span style="color: #000000">    p95: 3296.6</span>
<span style="color: #000000">    p99: 4186.5</span>
<span style="color: #000000">  Scenario counts:</span>
<span style="color: #000000">    0: 10 (100%)</span>
<span style="color: #000000">  Codes:</span>
<span style="color: #000000">    200: 200</span>
</code></pre>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class=" ">
						<a href="modules.html">Modules</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/app.html">app</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/lib_dependency.html">lib/dependency</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/persistence_cache.html">persistence/cache</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/routes_middleware.html">routes/middleware</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/routes_router.html">routes/router</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/utils_error.html">utils/error</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/utils_logger.html">utils/logger</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/utils_registry.html">utils/registry</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/utils_validation.html">utils/validation</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
</body>
</html>